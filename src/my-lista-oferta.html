
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="ofertas-listado.html">

<dom-module id="my-lista-oferta">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
        padding: 10px;
      }
      iron-pages {
        padding: 15px;
      }
      .nosesion {
        padding: 15px;
        margin: 10px 50px 0;
        color: #c33;
        background-color: #fcc;
        font-size: .8em;
        text-align: center;
        border: 1px solid #ccc;
      }
      .nosesion p {
        margin: 5px;
      }
      .nover{
        display: none;
      }
    </style>      
      <div class="nosesion nover" id="msgsesion" hidden$="[[user]]">
        <p>
          Para listar Promociones debes iniciar sesi贸n en la aplicaci贸n.
        </p>
        <p>
          Inicia sesi贸n con el bot贸n <iron-icon icon="account-circle"></iron-icon> de arriba a la derecha
        </p>
      </div>

    <h1>Listado de Ofertas y Cantidad de Views</h1>
    
    <div class="card">
      <firebase-query
        path="/ofertasUser/{{user.uid}}"
        data="{{oferta}}"
      ></firebase-query>

      <ofertas-listado
        name="Ofertas"
        items="{{oferta}}"
      ></ofertas-listado>
    </div>


  </template>
  <script>
    Polymer({
      is: 'my-lista-oferta',

      behaviors: [FirebaseBehavior],

      properties: {
        user: Object,
        seccion: {
          type: String,
          value: 'listado'
        },
        listaParticipaProm: {
          type: String,
          computed: 'fb__listaUserAll(user.uid)'
        },
        ofertasUser: Array,
        listp: Array
      },

      listeners: {
        'volver-listado': 'irListado',
        'editar-oferta': 'editaroferta',
      },

      ready: function() {
        this.async(this.mostrarMensajeLogueo, 2000);
      },

      mostrarMensajeLogueo: function() {
        this.toggleClass('nover', false, this.$.msgsesion);
      },

      add: function() {
        this.$.elinsertar.resetItem();
        this.seccion = 'insertar';
      },

      irListado: function() {
        this.seccion = 'listado';
      },

      editaroferta: function(e, oferta) {
        this.$.eleditar.item = oferta;
        this.seccion = 'editar';
      },
    });
  </script>
</dom-module>
