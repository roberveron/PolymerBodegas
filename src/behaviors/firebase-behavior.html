<script>
FirebaseBehavior = {
  properties: {
    fbapp: {
      type: Object,
      value: function() {
        return this.getFbapp();
      }
    }
  },
  getFbapp: function() {
    return document.createElement('iron-meta').byKey('fbapp');
  },
  
  fbref: function(ruta) {
    if(!this.fbapp) {
      this.fbapp = this.getFbapp();
    }
    return this.fbapp.database().ref(ruta);
  },

  // devuelve auth service
  fbauth: function() {
    if(!this.fbapp) {
      this.fbapp = this.getFbapp();
    }
    return this.fbapp.auth();
  },

  // USERS
  fb__userAll: function() {
    return '/users';
  },
  fb__userOne: function(id) {
    return this.fb__userAll() + '/' + id;
  },
  fb__userAvatar: function(id) {
    return this.fb__userOne(id) + '/avatar';
  },
  fb__userName: function(id) {
    return this.fb__userOne(id) + '/name';
  },

 // promociones_USUARIO
  fb__promocionesUserAll: function(id) {
    return '/promocionesUser/' + id;
  },
  fb__promocionesUserOne: function(id, key) {
    return this.fb__promocionesUserAll(id) + '/' + key;
  },
  fb_favpromocionUser: function(idUser, promocionLocData) {
    //console.log('fb_favpromocionUser', idUser, promocionLocData)
    return '/promocionesUserFavs/' + promocionLocData.userId + '/' + promocionLocData.slug + '/' + idUser
  },
  fb_favpromocionAll: function(promocionLocData) {
    //console.log('fb_favpromocionAll', '/promocionesUserFavs/' + promocionLocData.userId + '/' + promocionLocData.slug)
    return '/promocionesUserFavs/' + promocionLocData.userId + '/' + promocionLocData.slug;
  },

  // promociones GLOBALES
  fb__promocionesAll: function() {
    return '/promociones';
  },
  fb__promocionesOne: function(id) {
    return this.fb__promocionesAll() + '/' + id;
  },
  fb__numFavs: function(id) {
    return this.fb__promocionesOne(id) + '/numFavs'
  },

  // REQUEST promocion PUBLICO
  fb__requestPublicpromocionUser: function(uid) {
    return '/requestPublicpromocion/' + uid;
  },
  // REQUEST promocion PRIVADO
  fb__requestPrivatepromocionUser: function(uid) {
    return '/requestPrivatepromocion/' + uid;
  },
  // REQUEST SHARE TWITTER
  fb_twitterShareRequestUser: function(uid) {
    return '/twitter/shareRequest/' + uid;
  },
  // RESPONSE SHARE TWITTER
  fb_twitterShareResponseUser: function(uid) {
    return '/twitter/shareResponse/' + uid;
  },

  // NOTIFICATION REQUEST
  fb_notificationRequest: function(uid) {
    return '/notificationRequest/' + uid;
  },

  // NOTIFICATIONS USERS
  fb__notificationsUser: function(uid) {
    return '/notificationsUser/' + uid;
  },
  fb__notificationsUserOne: function(iduser, idnotif){
    return this.fb__notificationsUser(iduser) + '/' + idnotif;
  },

  // TOKEN DE USUARIO PARA NOTIFICACIONES PUSH
  fb__notificationTokenUser: function(id) {
    return '/userTokenPush/' + id + '/token';
  },

  //una referencia a un punto del storage
  fbStorageRef: function(ruta) {
    if(!this.fbapp) {
      this.fbapp = this.getFbapp();
    }
    return this.fbapp.storage().ref(ruta);
  },

  fs__promocionImage: function(uid, archivo) {
    return '/promociones/' + uid + '/' + archivo + '.png';
  },

 // ofertas_USUARIO
  fb__ofertasUserAll: function(id) {
    return '/ofertasUser/' + id;
  },
  fb__ofertasUserOne: function(id, key) {
    return this.fb__ofertasUserAll(id) + '/' + key;
  },
  fb_favofertaUser: function(idUser, ofertaLocData) {
    //console.log('fb_favofertaUser', idUser, ofertaLocData)
    return '/ofertasUserFavs/' + ofertaLocData.userId + '/' + ofertaLocData.slug + '/' + idUser
  },
  fb_favofertaAll: function(ofertaLocData) {
    //console.log('fb_favofertaAll', '/ofertasUserFavs/' + ofertaLocData.userId + '/' + ofertaLocData.slug)
    return '/ofertasUserFavs/' + ofertaLocData.userId + '/' + ofertaLocData.slug;
  },

  // ofertas GLOBALES
  fb__ofertasAll: function() {
    return '/ofertas';
  },
  fb__ofertasOne: function(id) {
    return this.fb__ofertasAll() + '/' + id;
  },
  fb__numFavs: function(id) {
    return this.fb__ofertasOne(id) + '/numFavs'
  },

  // REQUEST oferta PUBLICO
  fb__requestPublicofertaUser: function(uid) {
    return '/requestPublicoferta/' + uid;
  },
  // REQUEST oferta PRIVADO
  fb__requestPrivateofertaUser: function(uid) {
    return '/requestPrivateoferta/' + uid;
  },
  // REQUEST SHARE TWITTER
  fb_twitterShareRequestUser: function(uid) {
    return '/twitter/shareRequest/' + uid;
  },
  // RESPONSE SHARE TWITTER
  fb_twitterShareResponseUser: function(uid) {
    return '/twitter/shareResponse/' + uid;
  },

  // NOTIFICATION REQUEST
  fb_notificationRequest: function(uid) {
    return '/notificationRequest/' + uid;
  },

  // NOTIFICATIONS USERS
  fb__notificationsUser: function(uid) {
    return '/notificationsUser/' + uid;
  },
  fb__notificationsUserOne: function(iduser, idnotif){
    return this.fb__notificationsUser(iduser) + '/' + idnotif;
  },

  // TOKEN DE USUARIO PARA NOTIFICACIONES PUSH
  fb__notificationTokenUser: function(id) {
    return '/userTokenPush/' + id + '/token';
  },

  //una referencia a un punto del storage
  fbStorageRef: function(ruta) {
    if(!this.fbapp) {
      this.fbapp = this.getFbapp();
    }
    return this.fbapp.storage().ref(ruta);
  },

  fs__ofertaImage: function(uid, archivo) {
    return '/ofertas/' + uid + '/' + archivo + '.png';
  }
};
</script>